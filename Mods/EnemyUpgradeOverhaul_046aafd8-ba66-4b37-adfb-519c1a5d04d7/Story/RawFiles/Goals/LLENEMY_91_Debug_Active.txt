Version 1
SubGoalCombiner SGC_AND
INITSECTION

KBSECTION

IF
GameModeStarted(_,0)
THEN
GoalCompleted;

IF
GameStarted(_,0)
THEN
GoalCompleted;

IF
RegionStarted("TestLevel_LL_LeaderLib")
THEN
GlobalClearFlag("LLENEMY_DuplicationUpgradesDisabled");

IF
RegionStarted("_TMPL_Sandbox")
THEN
GlobalClearFlag("LLENEMY_DuplicationUpgradesDisabled");

IF
TextEventSet("llenemy_applystats")
THEN
LeaderLog_Log("TRACE", "[LLENEMY_20_DebugLevel:llenemy_applystats] Testing stats applying.");

IF
TextEventSet("llenemy_applystats")
AND
CharacterGetHostCharacter(_Player)
AND
LeaderLib_Recon_QRY_GetString("llenemy_applystats", "stats", 1, "Summon_Ice_Elemental")
AND
DB_LeaderLib_Recon_Temp_CommandParameters_String("llenemy_applystats", "stats", _Stats, _NextParamIndex)
AND
LeaderLib_Recon_QRY_GetUUID("llenemy_applystats", "target", _NextParamIndex, _Player)
AND
DB_LeaderLib_Recon_Temp_CommandParameters_UUID("llenemy_applystats", "target", _Target, _NextParamIndex2)
AND
String(_Target, _CharStr)
THEN
/* [OSITOOLS_ONLY]
NRD_LuaCall("LLENEMY_Ext_TraceCharacterStats", _CharStr);
*/
SetVarFixedString(_Target, "LLENEMY_ApplyStats_Stats", _Stats);
SetStoryEvent(_Target, "LLENEMY_ApplyStats");

IF
TextEventSet("llenemy_applystats")
THEN
LeaderLib_Recon_ClearParams("llenemy_applystats");

/* [OSITOOLS_ONLY]
IF
StoryEvent((CHARACTERGUID)_Char, "LLENEMY_ApplyStats_Done")
AND
String(_Char, _CharStr)
THEN
NRD_LuaCall("LLENEMY_Ext_TraceCharacterStats", _CharStr);
*/

//REGION CP_DEBUG
PROC
LLENEMY_Upgrades_OnRollingDone((CHARACTERGUID)_Char, (STRING)_Level)
AND
GetVarInteger(_Char, "LLENEMY_ChallengePoints", _ChallengePoints)
AND
_ChallengePoints > 0
AND
IntegertoString(_ChallengePoints, _PointsStr)
AND
CharacterGetDisplayName(_Char, _, _Name)
THEN
LeaderLog_Log("TRACE", "[LLENEMY:Upgrades:OnRollingDone] Enemy [",_Name,"] Challenge Points value is [",_PointsStr,"].");

IF
CharacterDied(_Char)
AND
GetVarInteger(_Char, "LLENEMY_ChallengePoints", _ChallengePoints)
AND
_ChallengePoints > 0
AND
IntegertoString(_ChallengePoints, _PointsStr)
AND
CharacterGetDisplayName(_Char, _, _Name)
THEN
LeaderLog_Log("TRACE", "[LLENEMY:Rewards:Debug] Enemy [",_Name,"] died. Challenge Points [",_PointsStr,"].");
//END_REGION

/* [OSITOOLS_ONLY]
IF
StoryEvent(_, "LeaderLib_Initialized")
THEN
NRD_LuaCall("LLENEMY_Ext_InitDebugLevel");
*/

IF
GameStarted(_,1)
THEN
GlobalSetFlag("LeaderLog_DebugStatus_Enabled");
GlobalSetFlag("LeaderLog_Debug_Enabled");

IF
GameStarted(_,1)
AND
ObjectExists(CHARACTERGUID_Trailer_Humans_Female_Lohse_000_145810cc-7e46-43e7-9fdf-ab9bb8ffcdc0, 1)
THEN
RemoveStatus(CHARACTERGUID_Trailer_Humans_Female_Lohse_000_145810cc-7e46-43e7-9fdf-ab9bb8ffcdc0, "LLENEMY_BONUSSKILLS_SINGLE");
RemoveStatus(CHARACTERGUID_Trailer_Humans_Female_Lohse_000_145810cc-7e46-43e7-9fdf-ab9bb8ffcdc0, "LLENEMY_UPGRADE_INFO");
LLENEMY_Upgrades_ApplyUpgrade(CHARACTERGUID_Trailer_Humans_Female_Lohse_000_145810cc-7e46-43e7-9fdf-ab9bb8ffcdc0, "BonusSkills", "Normal", "LLENEMY_BONUSSKILLS_SINGLE", -1.0, 2);
CharacterSetImmortal(CHARACTERGUID_Trailer_Humans_Female_Lohse_000_145810cc-7e46-43e7-9fdf-ab9bb8ffcdc0, 1);
ApplyStatus(CHARACTERGUID_Trailer_Humans_Female_Lohse_000_145810cc-7e46-43e7-9fdf-ab9bb8ffcdc0, "KNOCKED_DOWN", -1.0, 1, CHARACTERGUID_Trailer_Humans_Female_Lohse_000_145810cc-7e46-43e7-9fdf-ab9bb8ffcdc0);
SetCanJoinCombat(CHARACTERGUID_Trailer_Humans_Female_Lohse_000_145810cc-7e46-43e7-9fdf-ab9bb8ffcdc0, 0);

/* [OSITOOLS_ONLY]
PROC
LLENEMY_Upgrades_ApplyUpgrade((CHARACTERGUID)_Character, (STRING)_Group, (STRING)_Type, (STRING)_Status, (REAL)_Duration, (INTEGER)_CP)
AND
GlobalGetFlag("LLENEMY_HardModeEnabled", _HardMode)
AND
IntegertoString(_HardMode, _HardModeStr)
AND
String(_Character, _CharStr)
AND
NRD_RealToString(_Duration, _DurationStr)
AND
IntegertoString(_CP, _CPStr)
AND
StringConcatenate("[LLENEMY_20_DebugLevel:ApplyUpgrade] [", _Status, _Msg1)
AND
StringConcatenate(_Msg1, "] (", _Msg2)
AND
StringConcatenate(_Msg2, _CharStr, _Msg22)
AND
StringConcatenate(_Msg22, ") Duration (", _Msg3)
AND
StringConcatenate(_Msg3, _DurationStr, _Msg4)
AND
StringConcatenate(_Msg4, ") CP (", _Msg5)
AND
StringConcatenate(_Msg5, _CPStr, _Msg6)
THEN
NRD_LuaCall("LeaderLib_Ext_Log", _Msg6, ") Group(",_Group,") Type(",_Type,") HardMode(",_HardModeStr,")");
*/

EXITSECTION

ENDEXITSECTION
ParentTargetEdge "LLENEMY_91_Debug__Start"